<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Log samples from SquirrelMail &mdash; OSSEC</title>
    
    <link rel="stylesheet" href="../../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '2.8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../../about.html" />
    <link rel="top" title="OSSEC" href="../../../../index.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../index.html"><img src="../../../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../../../blog.html">Blog <i class="fa fa-archive"></i></a></li>
                <li><a href="../../../">Documentaton <i class="fa fa-book"></i></a></li>
                <li><a href="../../../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="log-samples-from-squirrelmail">
<h1>Log samples from SquirrelMail<a class="headerlink" href="#log-samples-from-squirrelmail" title="Permalink to this headline">¶</a></h1>
<p>SquirrelMail mostly connects with IMAP server 127.0.0.1 and the only one place where is information about client host is the Apache web server log. Successful login returns error code 302 (Found - redirection), unsuccessful login returns error code 200 (OK).</p>
<div class="section" id="login-successful">
<h2>Login successful:<a class="headerlink" href="#login-successful" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console"><div class="highlight"><pre><span class="go">192.168.1.99 - - [10/Jul/2009:11:30:17 +0200] &quot;POST /webmail/src/redirect.php HTTP/1.0&quot; 302 - &quot;http://my_mail_host/webmail/src/login.php&quot; &quot;Mozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.1) Gecko/20090630 Fedora/3.5-1.fc11 Firefox/3.5&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="login-unsuccessful">
<h2>Login unsuccessful:<a class="headerlink" href="#login-unsuccessful" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console"><div class="highlight"><pre><span class="go">192.168.1.99 - - [09/Jul/2009:15:26:58 +0200] &quot;POST /webmail/src/redirect.php HTTP/1.0&quot; 200 1105 &quot;http://my_mail_host/webmail/src/login.php&quot; &quot;Mozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.1) Gecko/20090630 Fedora/3.5-1.fc11 Firefox/3.5&quot;</span>
</pre></div>
</div>
<p>Corresponding lines from /var/log/maillog:</p>
</div>
<div class="section" id="success">
<h2>Success:<a class="headerlink" href="#success" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Jul 10 11:30:17 srv vpopmail[3676]: vchkpw-webmail: (PLAIN) login success mail_account:127.0.0.1</span>
<span class="go">Jul 10 11:30:17 srv dovecot: imap-login: Login: user=&lt;mail_account&gt;, method=PLAIN, rip=127.0.0.1, lip=127.0.0.1, secured</span>
</pre></div>
</div>
</div>
<div class="section" id="failure">
<h2>Failure:<a class="headerlink" href="#failure" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Jul  9 15:26:58 srv vpopmail[16745]: vchkpw-webmail: password fail (pass: &#39;test&#39;) mail_account:127.0.0.1</span>
<span class="go">Jul  9 15:27:00 srv dovecot: imap-login: Aborted login (auth failed, 1 attempts): user=&lt;mail_account&gt;, method=PLAIN, rip=127.0.0.1, lip=127.0.0.1, secured</span>
</pre></div>
</div>
</div>
<div class="section" id="my-local-rules">
<h2>My local rules:<a class="headerlink" href="#my-local-rules" title="Permalink to this headline">¶</a></h2>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;group</span> <span class="na">name=</span><span class="s">&quot;squirrelmail,&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131100&quot;</span> <span class="na">level=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>31108<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;url&gt;</span>/webmail/src/redirect.php<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail logins grouped.<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>

  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131101&quot;</span> <span class="na">level=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>131100<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;id&gt;</span>^302<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail: successfull login.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;group&gt;</span>authentication_success,<span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>

  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131102&quot;</span> <span class="na">level=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_sid&gt;</span>131100<span class="nt">&lt;/if_sid&gt;</span>
    <span class="nt">&lt;id&gt;</span>^200<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail: authentication failed.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;group&gt;</span>authentication_failures,<span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>

  <span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;131103&quot;</span> <span class="na">level=</span><span class="s">&quot;10&quot;</span> <span class="na">frequency=</span><span class="s">&quot;6&quot;</span> <span class="na">timeframe=</span><span class="s">&quot;300&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if_matched_sid&gt;</span>131102<span class="nt">&lt;/if_matched_sid&gt;</span>
    <span class="nt">&lt;same_source_ip</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;description&gt;</span>Squirrelmail brute force attack.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;group&gt;</span>attack, authentication_failures,<span class="nt">&lt;/group&gt;</span>
  <span class="nt">&lt;/rule&gt;</span>
<span class="nt">&lt;/group&gt;</span> <span class="c">&lt;!-- SQUIRRELMAIL --&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="separate-group-squirrelmail-allowing-to-get-report-about-webmail-logins">
<h2>Separate group &#8220;squirrelmail&#8221; allowing to get report about webmail logins:<a class="headerlink" href="#separate-group-squirrelmail-allowing-to-get-report-about-webmail-logins" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console"><div class="highlight"><pre><span class="go">cat /var/ossec/logs/alerts/alerts.log|/var/ossec/bin/ossec-reportd -f group squirrelmail</span>
</pre></div>
</div>
</div>
</div>

  <div class="section">
  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2015, OSSEC Project Team - OSSEC trademark and domain owned by Trend Micro, Inc. - Home page images courtesy of Pixbay.com.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>