<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sending alerts via syslog &mdash; OSSEC</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="top" title="OSSEC" href="../../../index.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../../blog.html">Blog <i class="fa fa-archive"></i></a></li>
                <li><a href="../../">Documentaton <i class="fa fa-book"></i></a></li>
                <li><a href="../../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="sending-alerts-via-syslog">
<span id="manual-out-syslog"></span><h1>Sending alerts via syslog<a class="headerlink" href="#sending-alerts-via-syslog" title="Permalink to this headline">¶</a></h1>
<p>Syslog output allows an OSSEC manager to send the OSSEC alerts to one or more syslog servers.
Because OSSEC only sends the alerts via syslog, these options are for server or local installations only.</p>
<p>OSSEC also supports sending alerts via cef, json, and to Splunk.</p>
<div class="section" id="configuration-options">
<h2>Configuration options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>These configurations options require a server or local installation.</p>
<dl class="element">
<dt id="element-syslog_output">
<code class="descname">syslog_output</code><a class="headerlink" href="#element-syslog_output" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="element">
<dt id="element-server">
<code class="descname">server</code><a class="headerlink" href="#element-server" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>IP Address of the syslog server.</li>
<li><strong>Allowed:</strong> any valid IP address</li>
</ul>
</dd></dl>

<dl class="element">
<dt id="element-port">
<code class="descname">port</code><a class="headerlink" href="#element-port" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>Port to forward alerts to.</li>
<li><strong>Default</strong> 514</li>
<li><strong>Allowed:</strong> Any valid port</li>
</ul>
</dd></dl>

<dl class="element">
<dt id="element-level">
<code class="descname">level</code><a class="headerlink" href="#element-level" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>Minimum alert level of the alerts to be forwarded.</li>
<li><strong>Allowed:</strong> 1 - 16</li>
</ul>
</dd></dl>

<dl class="element">
<dt id="element-group">
<code class="descname">group</code><a class="headerlink" href="#element-group" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>Alerts belonging to this group will be forwarded.</li>
<li><strong>Allowed:</strong> Any valid group. Separate multiple groups with the pipe (<code class="docutils literal"><span class="pre">|</span></code>) character.</li>
<li><strong>Examples:</strong></li>
</ul>
<div class="highlight-console"><div class="highlight"><pre><span class="go">&lt;group&gt;syscheck&lt;/group&gt;</span>
<span class="go">&lt;group&gt;authentication_failure|authentication_success&lt;/group&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="element">
<dt id="element-rule_id">
<code class="descname">rule_id</code><a class="headerlink" href="#element-rule_id" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>Alerts matching this rule_id will be forwarded.</li>
<li><strong>Allowed:</strong> Any valid rule_id</li>
</ul>
</dd></dl>

<dl class="element">
<dt id="element-location">
<code class="descname">location</code><a class="headerlink" href="#element-location" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>Alerts from this location will be forwarded.</li>
<li><strong>Allowed:</strong> Any valid logfile location</li>
</ul>
</dd></dl>

<dl class="element">
<dt id="element-use_fqdn">
<code class="descname">use_fqdn</code><a class="headerlink" href="#element-use_fqdn" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>By default, ossec truncates the hostname at the first period (&#8216;.&#8217;) when generating syslog messages. Setting this option to &#8216;yes&#8217; will cause it to use the full hostname configured on the server.</li>
<li><strong>Default</strong> no</li>
<li><strong>Allowed</strong> yes, no</li>
</ul>
</dd></dl>

<dl class="element">
<dt id="element-format">
<code class="descname">format</code><a class="headerlink" href="#element-format" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>Format of alert output. The default format is &#8220;default&#8221;, or full syslog output.</li>
<li>CEF is the ArcSight Common Event Format.</li>
<li>json can be used with a variety of tools.</li>
<li>The splunk option is for sending data to a Splunk server.</li>
<li><strong>Allowed</strong> default, cef, splunk, json</li>
<li><strong>Example:</strong></li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;syslog_output&gt;</span>
  <span class="nt">&lt;server&gt;</span>10.0.0.1<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;port&gt;</span>514<span class="nt">&lt;/port&gt;</span>
  <span class="nt">&lt;format&gt;</span>cef<span class="nt">&lt;/format&gt;</span>
<span class="nt">&lt;/syslog_output&gt;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="enabling-syslog-output">
<h2>Enabling Syslog output<a class="headerlink" href="#enabling-syslog-output" title="Permalink to this headline">¶</a></h2>
<p>An OSSEC server can be configured to send the alerts via syslog.
In this example all alerts are sent to 192.168.4.1, and alerts of level 10 and
above are also sent to 10.1.1.1:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;ossec_config&gt;</span>
  ...

  <span class="nt">&lt;syslog_output&gt;</span>
    <span class="nt">&lt;server&gt;</span>192.168.4.1<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;/syslog_output&gt;</span>

  <span class="nt">&lt;syslog_output&gt;</span>
    <span class="nt">&lt;level&gt;</span>10<span class="nt">&lt;/level&gt;</span>
    <span class="nt">&lt;server&gt;</span>10.1.1.1<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;/syslog_output&gt;</span>

  ...
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
<p>After this change is made, the client-syslog process should be enabled:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> /var/ossec/bin/ossec-control <span class="nb">enable </span>client-syslog
</pre></div>
</div>
<p>And finally restart the OSSEC processes:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> /var/ossec/bin/ossec-control restart
</pre></div>
</div>
<p>ossec-csyslog should start along with the other OSSEC processes:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Starting OSSEC HIDS v2.8 (by Trend Micro Inc.)...</span>
<span class="go">...</span>
<span class="go">Started ossec-csyslogd...</span>
<span class="go">...</span>
</pre></div>
</div>
<p>And in the logs:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> tail -n <span class="m">1000</span> /var/ossec/logs/ossec.log <span class="p">|</span> grep csyslog
<span class="go">2008/07/25 12:55:16 ossec-csyslogd: INFO: Started (pid: 19412).</span>
<span class="go">2008/07/25 12:55:16 ossec-csyslogd: INFO: Forwarding alerts via syslog to: ‘192.168.4.1:514′.</span>
<span class="go">2008/07/25 12:55:16 ossec-csyslogd: INFO: Forwarding alerts via syslog to: ‘10.1.1.1:514′.</span>
</pre></div>
</div>
<p>Here is an example of what the listening syslog daemon should receive (every log separated by level,
rule, location and the actual event that generated it):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Jul 25 12:17:41 enigma ossec: Alert Level: 3; Rule: 5715 - SSHD authentication success.; Location: (jul) 192.168.2.0-&gt;/var/log/messages;</span>
<span class="go">srcip: 192.168.2.190; user: root; Jul 25 13:26:24 slacker sshd[20440]: Accepted password for root from 192.168.2.190 port 49737 ssh2</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<span id="syslog-output-examples"></span><h2>Examples:<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="send-all-alerts-to-10-10-10-125">
<h3>Send all alerts to 10.10.10.125:<a class="headerlink" href="#send-all-alerts-to-10-10-10-125" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;syslog_output&gt;</span>
  <span class="nt">&lt;server&gt;</span>10.10.10.125<span class="nt">&lt;/server&gt;</span>
<span class="nt">&lt;/syslog_output&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="send-all-alerts-to-10-10-10-126-in-cef">
<h3>Send all alerts to 10.10.10.126 in CEF:<a class="headerlink" href="#send-all-alerts-to-10-10-10-126-in-cef" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;syslog_output&gt;</span>
  <span class="nt">&lt;server&gt;</span>10.10.10.126<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;format&gt;</span>cef<span class="nt">&lt;/format&gt;</span>
<span class="nt">&lt;/syslog_output&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="send-all-alerts-level-6-and-above-to-10-10-10-127-on-port-515">
<h3>Send all alerts level 6 and above to 10.10.10.127 on port 515:<a class="headerlink" href="#send-all-alerts-level-6-and-above-to-10-10-10-127-on-port-515" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;syslog_output&gt;</span>
  <span class="nt">&lt;server&gt;</span>10.10.10.127<span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;port&gt;</span>515<span class="nt">&lt;/port&gt;</span>
  <span class="nt">&lt;level&gt;</span>6<span class="nt">&lt;/level&gt;</span>
<span class="nt">&lt;/syslog_output&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>

  <div class="section">
  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2015, OSSEC Project Team - OSSEC trademark and domain owned by Trend Micro, Inc. - Home page images courtesy of Pixbay.com.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>