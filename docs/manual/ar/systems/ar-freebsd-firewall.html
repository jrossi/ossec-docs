<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Understanding Active Response with FreeBSD &mdash; OSSEC</title>
    
    <link rel="stylesheet" href="../../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '2.8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../../../about.html" />
    <link rel="top" title="OSSEC" href="../../../../index.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../index.html"><img src="../../../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../../../blog.html">Blog <i class="fa fa-archive"></i></a></li>
                <li><a href="../../../">Documentaton <i class="fa fa-book"></i></a></li>
                <li><a href="../../../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="understanding-active-response-with-freebsd">
<span id="manual-ar-freebsd-firewall"></span><h1>Understanding Active Response with FreeBSD<a class="headerlink" href="#understanding-active-response-with-freebsd" title="Permalink to this headline">¶</a></h1>
<p>There are currently 3 options for firewalls in <a class="reference external" href="http://www.freebsd.org/doc/en/books/handbook/firewalls.html">FreeBSD</a>: IPF, IPFW, and PF.
Each is configured differently on FreeBSD. OSSEC will attempt to check for IPFW and then PF, falling back to IPF if neither of these was found at the time of installation.</p>
<div class="section" id="how-does-ossec-know-which-firewall-is-being-used">
<h2>How does OSSEC know which firewall is being used?<a class="headerlink" href="#how-does-ossec-know-which-firewall-is-being-used" title="Permalink to this headline">¶</a></h2>
<p>The OSSEC install script will check <code class="docutils literal"><span class="pre">rc.conf</span></code> to determine which firewall is currently active.
It first greps for <code class="docutils literal"><span class="pre">firewall_enable=&quot;YES&quot;</span></code>, and enables IPFW if this is found. IPFW support is enabled by copying the <code class="docutils literal"><span class="pre">ipfw.sh</span></code> to <code class="docutils literal"><span class="pre">/var/ossec/active-response/bin/firewall-drop.sh</span></code>.
The installation script will then look for <a href="#id1"><span class="problematic" id="id2">``</span></a>pf_enable=&#8221;YES&#8221;` in the rc.conf, and will enable PF instead if this is found. The script for pf is pf.sh.
If neither of these is found, the default firewall-drop.sh script will be installed. This script will use attempt to use IPF to block IPs.</p>
</div>
<div class="section" id="how-do-i-change-which-script-is-used-by-an-agent">
<h2>How do I change which script is used by an agent?<a class="headerlink" href="#how-do-i-change-which-script-is-used-by-an-agent" title="Permalink to this headline">¶</a></h2>
<p>Copy the appropriate script from the OSSEC source to <code class="docutils literal"><span class="pre">/var/ossec/active-response/bin/firewall-drop.sh</span></code> on the agent.</p>
</div>
</div>

  <div class="section">
  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2015, OSSEC Project Team - OSSEC trademark and domain owned by Trend Micro, Inc. - Home page images courtesy of Pixbay.com.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>