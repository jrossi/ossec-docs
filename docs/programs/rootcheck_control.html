<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>rootcheck_control &mdash; OSSEC</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="OSSEC" href="../../index.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../blog.html">Blog <i class="fa fa-archive"></i></a></li>
                <li><a href="../">Documentaton <i class="fa fa-book"></i></a></li>
                <li><a href="../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="rootcheck-control">
<span id="id1"></span><h1>rootcheck_control<a class="headerlink" href="#rootcheck-control" title="Permalink to this headline">¶</a></h1>
<p>The rootcheck_control tool allows you to manage the policy monitoring and system auditing database that is stored on the server (manager) side. You can list anomalies detected by the rootcheck functionality, categorized into resolved and outstanding issues. Moreover you can find out when ossec-rootcheck was run the last time.</p>
<div class="section" id="rootcheck-control-argument-options">
<h2>rootcheck_control argument options<a class="headerlink" href="#rootcheck-control-argument-options" title="Permalink to this headline">¶</a></h2>
<dl class="option">
<dt id="cmdoption-rootcheck_control-h">
<code class="descname">-h</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-rootcheck_control-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Display the help message.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-l">
<code class="descname">-l</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-rootcheck_control-l" title="Permalink to this definition">¶</a></dt>
<dd><p>List available agents.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-lc">
<code class="descname">-lc</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-rootcheck_control-lc" title="Permalink to this definition">¶</a></dt>
<dd><p>List only currently connected agents.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-u">
<code class="descname">-u</code><code class="descclassname"> &lt;id&gt;</code><a class="headerlink" href="#cmdoption-rootcheck_control-u" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates (clear) the database for the agent.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-u">
<code class="descname">-u</code><code class="descclassname"> all</code><a class="headerlink" href="#cmdoption-rootcheck_control-u" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates (clear) the database for all agents.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-i">
<code class="descname">-i</code><code class="descclassname"> &lt;agent_id&gt;</code><a class="headerlink" href="#cmdoption-rootcheck_control-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints database for the agent.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-r">
<code class="descname">-r</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-rootcheck_control-r" title="Permalink to this definition">¶</a></dt>
<dd><p>Used with -i, prints all the resolved issues.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-q">
<code class="descname">-q</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-rootcheck_control-q" title="Permalink to this definition">¶</a></dt>
<dd><p>Used with -i, prints all the outstanding issues.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-L">
<code class="descname">-L</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-rootcheck_control-L" title="Permalink to this definition">¶</a></dt>
<dd><p>Used with -i, prints the last scan.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-rootcheck_control-s">
<code class="descname">-s</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-rootcheck_control-s" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the output to CSV (comma delimited).</p>
</dd></dl>

</div>
<div class="section" id="rootcheck-control-example-usage">
<h2>rootcheck_control example usage<a class="headerlink" href="#rootcheck-control-example-usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-getting-a-list-of-system-auditing-policy-monitoring-events">
<h3>Example 1: Getting a list of system auditing/policy monitoring events<a class="headerlink" href="#example-1-getting-a-list-of-system-auditing-policy-monitoring-events" title="Permalink to this headline">¶</a></h3>
<p>To get a list of all auditing/policy monitoring events for a specific agent, you can run <code class="xref std std-option docutils literal"><span class="pre">rootcheck_control</span> <span class="pre">-i</span></code>. To retrieve the agent id you can use any of the following commands:</p>
<ul class="simple">
<li><a class="reference internal" href="#cmdoption-rootcheck_control-l"><code class="xref std std-option docutils literal"><span class="pre">rootcheck_control</span> <span class="pre">-l</span></code></a>,</li>
<li><a class="reference internal" href="agent_control.html#cmdoption-agent_control-l"><code class="xref std std-option docutils literal"><span class="pre">agent_control</span> <span class="pre">-l</span></code></a></li>
<li><a class="reference internal" href="syscheck_control.html#cmdoption-syscheck_control-l"><code class="xref std std-option docutils literal"><span class="pre">syscheck_control</span> <span class="pre">-l</span></code></a></li>
<li><a class="reference internal" href="syscheck_update.html#cmdoption-syscheck_update-l"><code class="xref std std-option docutils literal"><span class="pre">syscheck_update</span> <span class="pre">-l</span></code></a></li>
<li><a class="reference internal" href="manage_agents.html#cmdoption-manage_agents-l"><code class="xref std std-option docutils literal"><span class="pre">manage_agents</span> <span class="pre">-l</span></code></a></li>
</ul>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> /var/ossec/bin/rootcheck_control -i 002

<span class="go">Policy and auditing events for agent &#39;ossecagent (002) - 192.168.1.86&#39;:</span>

<span class="go">Resolved events:</span>

<span class="go">2010 Jun 15 13:01:22 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Debian Linux 8.8 - GRUB Password not set. File: /boot/grub/menu.lst. Reference: http://www.ossec.net/wiki/index.php/CIS_DebianLinux .</span>


<span class="go">Outstanding events:</span>

<span class="go">2010 Jun 17 17:34:37 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Testing against the CIS Debian Linux Benchmark v1.0. File: /etc/debian_version. Reference: http://www.ossec.net/wiki/index.php/CIS_DebianLinux .</span>

<span class="go">2010 Jun 17 17:34:37 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Debian Linux 1.4 - Robust partition scheme - /tmp is not on its own partition. File: /etc/fstab. Reference: http://www.ossec.net/wiki/index.php/CIS_DebianLinux .</span>

<span class="go">2010 Jun 17 17:34:37 (first time detected: 2009 Dec 10 18:48:43)</span>
<span class="go">System Audit: System Audit: CIS - Debian Linux 2.3 - SSH Configuration - Root login allowed. File: /etc/ssh/sshd_config. Reference: http://www.ossec.net/wiki/index.php/CIS_DebianLinux .</span>
</pre></div>
</div>
<p>As you can see the detected events are shown in two categories, resolved events and outstanding event. To only show resolved events, run <code class="xref std std-option docutils literal"><span class="pre">rootcheck_control</span> <span class="pre">-ri</span></code>.
To only show outstanding events, run <code class="xref std std-option docutils literal"><span class="pre">rootcheck_control</span> <span class="pre">-qi</span></code>.
To only show the results of the last scan and time of that scan, run <code class="xref std std-option docutils literal"><span class="pre">rootcheck_control</span> <span class="pre">-Li</span></code>.</p>
<p>To gain that kind of information for the OSSEC server, run <code class="xref std std-option docutils literal"><span class="pre">rootcheck_control</span> <span class="pre">-i</span> <span class="pre">000</span></code>.</p>
</div>
<div class="section" id="example-2-clearing-the-system-auditing-policy-database">
<h3>Example 2: Clearing the system auditing/policy database<a class="headerlink" href="#example-2-clearing-the-system-auditing-policy-database" title="Permalink to this headline">¶</a></h3>
<p>To clear the system auditing/policy monitoring database for a certain agent run the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> /var/ossec/bin/rootcheck_control -u 002

<span class="go">** Policy and auditing database updated.</span>
</pre></div>
</div>
<p>To clear the database for all agents and the server run the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">#</span> /var/ossec/bin/rootcheck_control -u all

<span class="go">** Policy and auditing database updated.</span>
</pre></div>
</div>
<p>The next time rootcheck is run, the database will be populated again.</p>
</div>
</div>
</div>

  <div class="section">
  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2015, OSSEC Project Team - OSSEC trademark and domain owned by Trend Micro, Inc. - Home page images courtesy of Pixbay.com.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>