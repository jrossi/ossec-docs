<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Alerts: FAQ &mdash; OSSEC</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="OSSEC" href="../../index.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../blog.html">Blog <i class="fa fa-archive"></i></a></li>
                <li><a href="../">Documentaton <i class="fa fa-book"></i></a></li>
                <li><a href="../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="alerts-faq">
<span id="faq-alerts"></span><h1>Alerts: FAQ<a class="headerlink" href="#alerts-faq" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#how-do-you-monitor-for-usb-storage" id="id1">How do you monitor for usb storage?</a></li>
<li><a class="reference internal" href="#why-do-i-see-alerts-for-agent2-in-an-email-about-agent1" id="id2">Why do I see alerts for agent2 in an email about agent1?</a></li>
<li><a class="reference internal" href="#alerts-for-different-sensors-are-appearing-in-the-same-email-how-do-i-stop-this-from-happening" id="id3">Alerts for different sensors are appearing in the same email, how do I stop this from happening?</a></li>
<li><a class="reference internal" href="#how-do-i-ignore-rule-1002" id="id4">How do I ignore rule 1002?</a></li>
<li><a class="reference internal" href="#i-set-the-email-alert-level-to-10-why-do-i-keep-seeing-rules-with-lower-levels" id="id5">I set the &lt;email_alert_level&gt; to 10, why do I keep seeing rules with lower levels?</a></li>
<li><a class="reference internal" href="#why-are-all-of-my-windows-alerts-showing-up-as-rule-1002" id="id6">Why are all of my Windows alerts showing up as rule 1002?</a></li>
<li><a class="reference internal" href="#i-keep-getting-log-messages-that-start-with-mark-what-do-i-do" id="id7">I keep getting log messages that start with <code class="docutils literal"><span class="pre">--MARK</span></code>, what do I do?</a></li>
</ul>
</div>
<div class="section" id="how-do-you-monitor-for-usb-storage">
<span id="usb-storage"></span><h2><a class="toc-backref" href="#id1">How do you monitor for usb storage?</a><a class="headerlink" href="#how-do-you-monitor-for-usb-storage" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The first step is to configure the agents to check a registry entry with the <code class="docutils literal"><span class="pre">reg</span></code> command:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;agent_config</span> <span class="na">os=</span><span class="s">&quot;Windows&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;localfile&gt;</span>
    <span class="nt">&lt;log_format&gt;</span>full_command<span class="nt">&lt;/log_format&gt;</span>
    <span class="nt">&lt;command&gt;</span>reg QUERY HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR<span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;alias&gt;</span>usb-check<span class="nt">&lt;/alias&gt;</span>
  <span class="nt">&lt;/localfile&gt;</span>
<span class="nt">&lt;/agent_config&gt;</span>
</pre></div>
</div>
<p>Next create a local rule for that command:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&quot;140125&quot;</span> <span class="na">level=</span><span class="s">&quot;7&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;if_sid&gt;</span>530<span class="nt">&lt;/if_sid&gt;</span>
  <span class="nt">&lt;match&gt;</span>ossec: output: &#39;usb-check&#39;:<span class="nt">&lt;/match&gt;</span>
  <span class="nt">&lt;check_diff</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;description&gt;</span>New USB device connected<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;/rule&gt;</span>
</pre></div>
</div>
<p>When a USB drive is inserted into a Windows machine, an alert will not be triggered.
The alert will contain a diff of the registry entry before the USB device was inserted and after.</p>
<p>Originally from: &#8216;<a class="reference external" href="http://dcid.me/2010/03/detecting-usb-storage-usage-with-ossec/">http://dcid.me/2010/03/detecting-usb-storage-usage-with-ossec/</a>&#8216;</p>
<p>Additional data from: &#8216;<a class="reference external" href="http://blog.rootshell.be/2010/03/15/detecting-usb-storage-usage-with-ossec/">http://blog.rootshell.be/2010/03/15/detecting-usb-storage-usage-with-ossec/</a>&#8216;</p>
</div></blockquote>
</div>
<div class="section" id="why-do-i-see-alerts-for-agent2-in-an-email-about-agent1">
<span id="grouped-email-alerts"></span><h2><a class="toc-backref" href="#id2">Why do I see alerts for agent2 in an email about agent1?</a><a class="headerlink" href="#why-do-i-see-alerts-for-agent2-in-an-email-about-agent1" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>When an email is being prepared alerts will be grouped together. The only real criteria for grouping alerts together is the timeframe.
To prevent alerts from being grouped together you can set <code class="docutils literal"><span class="pre">maild.groupping</span></code> to 0 in <code class="docutils literal"><span class="pre">/var/ossec/etc/internal_options.conf</span></code>.
If this is set, alerts will be sent out individually. By default OSSEC will only send 12 emails per hour.
To increase this limit, modify or add the &lt;email_maxperhour&gt; setting in the <code class="docutils literal"><span class="pre">&lt;global&gt;</span></code> section of the <code class="docutils literal"><span class="pre">ossec.conf</span></code>.
(see: <a class="reference external" href="../syntax/head_ossec_config.global.html#element-email_maxperhour">email_maxperhour</a> .)</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;global&gt;</span>
  <span class="nt">&lt;email_maxperhour&gt;</span>100<span class="nt">&lt;/email_maxperhour&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="alerts-for-different-sensors-are-appearing-in-the-same-email-how-do-i-stop-this-from-happening">
<span id="herp-derp-grouping"></span><h2><a class="toc-backref" href="#id3">Alerts for different sensors are appearing in the same email, how do I stop this from happening?</a><a class="headerlink" href="#alerts-for-different-sensors-are-appearing-in-the-same-email-how-do-i-stop-this-from-happening" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Read the previous FAQ entry.</div></blockquote>
</div>
<div class="section" id="how-do-i-ignore-rule-1002">
<span id="ignore-1002"></span><h2><a class="toc-backref" href="#id4">How do I ignore rule 1002?</a><a class="headerlink" href="#how-do-i-ignore-rule-1002" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Rule 1002 is a catch-all rule. It looks for keywords that are generally considered &#8220;bad.&#8221;
It also means there is not currently a rule that deals with the log message.
It is configured to always send an email when it&#8217;s triggered, and many users have found it annoying.
The best thing to do when you encounter something that triggers rule 1002 is write a rule.
Contributing the logs and/or rules back to the project is also encouraged.
Unless the application creating the log is an internal application, someone else may find the rule useful.</div></blockquote>
</div>
<div class="section" id="i-set-the-email-alert-level-to-10-why-do-i-keep-seeing-rules-with-lower-levels">
<span id="too-many-emails"></span><h2><a class="toc-backref" href="#id5">I set the &lt;email_alert_level&gt; to 10, why do I keep seeing rules with lower levels?</a><a class="headerlink" href="#i-set-the-email-alert-level-to-10-why-do-i-keep-seeing-rules-with-lower-levels" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Some rules have an option set to force OSSEC into sending an alert email. This option is <code class="docutils literal"><span class="pre">&lt;options&gt;alert_by_email&lt;/options&gt;</span></code>.
One of these rules is 1002. To ignore these rules you will have to create a rule to specifically ignore it,
or overwrite the rule without the <code class="docutils literal"><span class="pre">alert_by_email</span></code> option.</div></blockquote>
</div>
<div class="section" id="why-are-all-of-my-windows-alerts-showing-up-as-rule-1002">
<span id="too-much-1002"></span><h2><a class="toc-backref" href="#id6">Why are all of my Windows alerts showing up as rule 1002?</a><a class="headerlink" href="#why-are-all-of-my-windows-alerts-showing-up-as-rule-1002" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>This is a known issue when using an older version on the OSSEC manager and newer versions on the agents.
The manager should never be an older version than the agents. Using the same version is ideal, but when
that is not possible, the manager should be the newest version.</div></blockquote>
</div>
<div class="section" id="i-keep-getting-log-messages-that-start-with-mark-what-do-i-do">
<span id="mark"></span><h2><a class="toc-backref" href="#id7">I keep getting log messages that start with <code class="docutils literal"><span class="pre">--MARK</span></code>, what do I do?</a><a class="headerlink" href="#i-keep-getting-log-messages-that-start-with-mark-what-do-i-do" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><strong>Example:</strong></p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">OSSEC HIDS Notification.</span>
<span class="go">2014 Sep 21 08:36:11</span>

<span class="go">Received From: (services01.qrios.com) 10.10.0.01-&gt;ossec-keepalive</span>
<span class="go">Rule: 1002 fired (level 2) -&gt; &quot;Unknown problem somewhere in the system.&quot;</span>
<span class="go">Portion of the log(s):</span>

<span class="go">--MARK--: cB82L!#&#39;zr%lQfGUE))-7Q#Tj4fp+KG=@Wbq^wXiN)7L;ha!JB0kA_mJT5g-j[v_R@TAbk-,/fHEnHjerroRgAIh?OLWJ6LIL/q[Wg-cl#H#n/&amp;(3NDr$@#v8r*l;!b*qru$@YxEE4Zak=(wEqN0JuDlLo!*HtlXKF(3.kQ&amp;wj&amp;+aklF%YNsA&amp;*#Mef)xq&#39;qd@)P+Dz0[jP]70%Q6vqbfbv?fA)D?#bc?_R+6y.i+MdXUzhucx9V#MV($-3uk4!ja!MocJx;D%P=We0Y^DoV&amp;r+fha$rmRA1v$^y4U4cD1&#39;H5T?OF1R3(Hq&#39;H.YcO&#39;3soM/(P2_A@w7K^6G2C=z2#.W2[24=VBXrvVe!5;eKotCM[8W!hE_CB;/!Vk1k&#39;sCov_H[u&#39;(=no*VEH$&#39;@1vVU7zj*I7s0RHD)w@ipX?&amp;@y)X50Q&#39;w#OyN$+$pW?xW_0JYFRwK/g3wIuKc!D#Q*eMg&#39;79/oaURi.j].))JIQ6&amp;!k(O]ZN#lHATidRwRTvhQFQ]6DFiBT;fltbg(OALDi/LlPqkcL5bypK?axVByOGJp+.P(@[p)&#39;j</span>
</pre></div>
</div>
<p>This is a keep alive message, sent from an OSSEC agent to the manager. Thie prevents the manager from marking the agent as disconnected. These log messages should be filtered out, but sometimes one slips through (this one has the string <code class="docutils literal"><span class="pre">erroR</span></code> which may be the cause). These should be safe to ignore.</p>
</div></blockquote>
</div>
</div>

  <div class="section">
  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2015, OSSEC Project Team - OSSEC trademark and domain owned by Trend Micro, Inc. - Home page images courtesy of Pixbay.com.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>