<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OSSEC: FAQ &mdash; OSSEC</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="OSSEC" href="../../index.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../blog.html">Blog <i class="fa fa-archive"></i></a></li>
                <li><a href="../">Documentaton <i class="fa fa-book"></i></a></li>
                <li><a href="../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="ossec-faq">
<span id="faq-ossec"></span><h1>OSSEC: FAQ<a class="headerlink" href="#ossec-faq" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#can-an-ossec-manager-have-more-than-256-agents" id="id1">Can an OSSEC manager have more than 256 agents?</a></li>
<li><a class="reference internal" href="#where-are-ossec-s-logs-stored" id="id2">Where are OSSEC&#8217;s logs stored?</a></li>
<li><a class="reference internal" href="#where-can-i-view-the-logs-sent-to-an-ossec-manager-or-on-a-local-install" id="id3">Where can I view the logs sent to an OSSEC manager (or on a local install)?</a></li>
<li><a class="reference internal" href="#can-ossec-s-logs-be-saved-to-a-different-directory" id="id4">Can OSSEC&#8217;s logs be saved to a different directory?</a></li>
<li><a class="reference internal" href="#i-m-getting-an-error-when-starting-ossec-ossec-analysisd-testing-rules-failed-configuration-error-exiting-why" id="id5">I&#8217;m getting an error when starting OSSEC: &#8220;OSSEC analysisd: Testing rules failed. Configuration error. Exiting.&#8221; Why?</a></li>
<li><a class="reference internal" href="#the-rules-aren-t-on-my-agents-they-re-only-on-the-server" id="id6">The rules aren&#8217;t on my agents, they&#8217;re only on the server!</a></li>
<li><a class="reference internal" href="#do-the-rules-get-pushed-to-the-agents-automatically" id="id7">Do the rules get pushed to the agents automatically?</a></li>
<li><a class="reference internal" href="#how-can-i-get-ossec-log-to-rotate-daily" id="id8">How can I get ossec.log to rotate daily?</a></li>
</ul>
</div>
<div class="section" id="can-an-ossec-manager-have-more-than-256-agents">
<h2><a class="toc-backref" href="#id1">Can an OSSEC manager have more than 256 agents?</a><a class="headerlink" href="#can-an-ossec-manager-have-more-than-256-agents" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>By default OSSEC limits the number of agents to 256 per manager. This limitation is set in the code, but can be modified at compile time.
Depending on the event load, a manager running on modern hardware can handle many more agents.
Some users have more than 1000 agents on a single manager.
To change the maximum number of agents, cd into the src directory and run the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">make setmaxagents</span>
</pre></div>
</div>
<p>You should be prompted for the number of agents to allow.</p>
<p>One issue you may face after changing this setting is the number of files allowed to be open for a single user.
The users <code class="docutils literal"><span class="pre">ossec</span></code> and <code class="docutils literal"><span class="pre">ossecr</span></code> both open at least 1 file (syscheck database and rids file) per agent.
Raising this limit is operating system specific.</p>
<p>Some Linux distributions support a <code class="docutils literal"><span class="pre">/etc/security/limits.conf</span></code>. Set the limits to be at least a few files above what the max agents is set to.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">ossec            soft    nofile          2048</span>
<span class="go">ossec            hard    nofile          2048</span>
<span class="go">ossecr           soft    nofile          2048</span>
<span class="go">ossecr           hard    nofile          2048</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="where-are-ossec-s-logs-stored">
<h2><a class="toc-backref" href="#id2">Where are OSSEC&#8217;s logs stored?</a><a class="headerlink" href="#where-are-ossec-s-logs-stored" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>On OSSEC server and local installs there are several classes of OSSEC logs.
There are the logs created by the OSSEC daemons, the log messages from the agents, and the alerts.
Agent installs do not have logs from other agents or alerts, but do have logs created by the OSSEC processes.</p>
<p>All logs are stored in subdirectories of <code class="docutils literal"><span class="pre">/var/ossec/logs</span></code>.
OSSEC&#8217;s log messages are stored in <code class="docutils literal"><span class="pre">/var/ossec/logs/ossec.log</span></code>.</p>
<p>Log messages from the agents are not stored by default. After analysis they are deleted unless the &lt;logall&gt; option is included in the manager&#8217;s ossec.conf.
If set all log messages sent to the manager are stored in <code class="docutils literal"><span class="pre">/var/ossec/logs/archives/archives.log</span></code> and rotated daily.</p>
<p>Alerts are stored in <code class="docutils literal"><span class="pre">/var/ossec/logs/alerts/alerts.log</span></code>, and rotated daily.</p>
</div></blockquote>
</div>
<div class="section" id="where-can-i-view-the-logs-sent-to-an-ossec-manager-or-on-a-local-install">
<h2><a class="toc-backref" href="#id3">Where can I view the logs sent to an OSSEC manager (or on a local install)?</a><a class="headerlink" href="#where-can-i-view-the-logs-sent-to-an-ossec-manager-or-on-a-local-install" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>OSSEC does not store the logs sent to it by default. If a log does not trigger an alert it is discarded, and logs that do trigger alerts are stored with the alerts in <code class="docutils literal"><span class="pre">/var/ossec/logs/alerts</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">&lt;log-all&gt;</span></code> option can be added to the <code class="docutils literal"><span class="pre">&lt;global&gt;</span></code> section (see: <a class="reference internal" href="../syntax/head_ossec_config.global.html#ossec-config-global"><span>ossec.conf: Global options</span></a>) of the manager&#8217;s ossec.conf. The manager&#8217;s OSSEC processes should be restarted.
The raw logs will then be saved to files, organized by date, in <code class="docutils literal"><span class="pre">/var/ossec/logs/archives</span></code>.</p>
<p>The headers attached to these log messages are in the format of <code class="docutils literal"><span class="pre">&quot;YYYY</span> <span class="pre">Month</span> <span class="pre">dd</span> <span class="pre">HH:MM:ss</span> <span class="pre">agent_name-&gt;/path/to/log/file</span> <span class="pre">&quot;</span></code>.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">2011 Aug 04 00:00:01 server-&gt;/var/log/local7 Aug  4 00:00:26 server named[29909]: client 192.168.1.7#39323: query: fake.example.net IN AAAA +</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="can-ossec-s-logs-be-saved-to-a-different-directory">
<h2><a class="toc-backref" href="#id4">Can OSSEC&#8217;s logs be saved to a different directory?</a><a class="headerlink" href="#can-ossec-s-logs-be-saved-to-a-different-directory" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>As a protection mechanism, OSSEC chroots most of its processes to the install directory (typically <code class="docutils literal"><span class="pre">/var/ossec</span></code>).
Due to this chroot, logs must be saved to a location under <code class="docutils literal"><span class="pre">/var/ossec</span></code>.
OSSEC does rotate its logs, but will not be able to move them from <code class="docutils literal"><span class="pre">/var/ossec</span></code>.</p>
<p>Be sure to allocate enough space to <code class="docutils literal"><span class="pre">/var/ossec</span></code>.</p>
</div></blockquote>
</div>
<div class="section" id="i-m-getting-an-error-when-starting-ossec-ossec-analysisd-testing-rules-failed-configuration-error-exiting-why">
<h2><a class="toc-backref" href="#id5">I&#8217;m getting an error when starting OSSEC: &#8220;OSSEC analysisd: Testing rules failed. Configuration error. Exiting.&#8221; Why?</a><a class="headerlink" href="#i-m-getting-an-error-when-starting-ossec-ossec-analysisd-testing-rules-failed-configuration-error-exiting-why" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>There was a small bug in the ossec-control script that was not caught in time for 2.6.
The error comes from the script trying to run ossec-logtest from the wrong directory.
The solution is to change the line where ossec-logtest is running to look like this:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">echo | ${DIR}/bin/ossec-logtest &gt; /dev/null 2&gt;&amp;1;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="the-rules-aren-t-on-my-agents-they-re-only-on-the-server">
<h2><a class="toc-backref" href="#id6">The rules aren&#8217;t on my agents, they&#8217;re only on the server!</a><a class="headerlink" href="#the-rules-aren-t-on-my-agents-they-re-only-on-the-server" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>That&#8217;s not a question. Also, that&#8217;s the way it is. Only the server has the rules. Agents do not get a copy of the rules.</div></blockquote>
</div>
<div class="section" id="do-the-rules-get-pushed-to-the-agents-automatically">
<h2><a class="toc-backref" href="#id7">Do the rules get pushed to the agents automatically?</a><a class="headerlink" href="#do-the-rules-get-pushed-to-the-agents-automatically" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>The rules only exist on the manager. All analysis is done on the manager.
Agents do not send alerts to the manager, they only send the raw logs.</div></blockquote>
</div>
<div class="section" id="how-can-i-get-ossec-log-to-rotate-daily">
<h2><a class="toc-backref" href="#id8">How can I get ossec.log to rotate daily?</a><a class="headerlink" href="#how-can-i-get-ossec-log-to-rotate-daily" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Currently OSSEC does not rotate the <code class="docutils literal"><span class="pre">ossec.log</span></code>, use logrotate.d or newsyslog to rotate it for now.</div></blockquote>
</div>
</div>

  <div class="section">
  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2015, OSSEC Project Team - OSSEC trademark and domain owned by Trend Micro, Inc. - Home page images courtesy of Pixbay.com.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>