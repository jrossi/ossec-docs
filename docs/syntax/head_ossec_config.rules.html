<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ossec.conf: Rules options &mdash; OSSEC</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/parallax.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="OSSEC" href="../../index.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/ossec_logo_bare_small.png">
          OSSEC</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../about.html">About <i class="fa fa-info-circle"></i></a></li>
                <li><a href="../../blog.html">Blog <i class="fa fa-archive"></i></a></li>
                <li><a href="../">Documentaton <i class="fa fa-book"></i></a></li>
                <li><a href="../../downloads.html">Downloads <i class="fa fa-download"></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="ossec-conf-rules-options">
<span id="ossec-config-rules"></span><h1>ossec.conf: Rules options<a class="headerlink" href="#ossec-conf-rules-options" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="section" id="supported-types">
<h3>Supported types<a class="headerlink" href="#supported-types" title="Permalink to this headline">¶</a></h3>
<p>Rules options are available in the the following installation types:</p>
<ul class="simple">
<li>server</li>
<li>local</li>
</ul>
</div>
<div class="section" id="location">
<h3>Location<a class="headerlink" href="#location" title="Permalink to this headline">¶</a></h3>
<p>All global options must be configured in the /var/ossec/etc/ossec.conf
and used within the &lt;ossec_config&gt; tag.</p>
<p>XML excerpt to show location:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;ossec_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">        Rules options here</span>
<span class="c">        --&gt;</span>
    <span class="nt">&lt;/rules&gt;</span>
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<dl class="element">
<dt id="element-include">
<code class="descname">include</code><a class="headerlink" href="#element-include" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a single rule file.</p>
<p><strong>Allowed:</strong> Path and file name of rule to load example: rules/config.xml</p>
</dd></dl>

<dl class="element">
<dt id="element-rule">
<code class="descname">rule</code><a class="headerlink" href="#element-rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a single rule file.</p>
<p><strong>Allowed:</strong> Path and file name of rule to load example: rules/config.xml</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is the same as include, but created to keep the syntax constant with
other sections of the rules config.</p>
</div>
</dd></dl>

<dl class="element">
<dt id="element-rule_dir">
<code class="descname">rule_dir</code><a class="headerlink" href="#element-rule_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a directory of rules.  The order of loaded files will be in alphebical order
and will not load any files that have been loaded before.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><p class="first"><em>pattern</em>: is a regex match string use to determine if a file needs to be
loaded.</p>
<blockquote>
<div><ul class="simple">
<li><em>Defaults</em>: regex &#8220;_rules.xml$&#8221; is used unless another one is specified.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p><strong>Allowed:</strong> Path to a directory of rule files</p>
<p><strong>Example:</strong></p>
<ol class="arabic">
<li><p class="first">Loading all rules in directory /var/ossec/rules ending ending with _rules.xml</p>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;ossec_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;rule_dir&gt;</span>rules<span class="nt">&lt;/rule_dir&gt;</span>
    <span class="nt">&lt;/rules&gt;</span>
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Loading all rules in directory /var/ossec/rules/plugins ending with .xml</p>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;ossec_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;rule_dir</span> <span class="na">pattern=</span><span class="s">&quot;.xml$&quot;</span><span class="nt">&gt;</span>rules<span class="nt">&lt;/rule_dir&gt;</span>
    <span class="nt">&lt;/rules&gt;</span>
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</dd></dl>

<dl class="element">
<dt id="element-decoder">
<code class="descname">decoder</code><a class="headerlink" href="#element-decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a single decoder file. The path should be relative to the install directory, typically <code class="docutils literal"><span class="pre">/var/ossec</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If no decoders are specified in ossec.conf the legacy <code class="docutils literal"><span class="pre">etc/decoder.xml</span></code> and
<code class="docutils literal"><span class="pre">etc/local_decoder.xml</span></code> are loaded</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If <code class="docutils literal"><span class="pre">&lt;decoder&gt;</span></code> or <code class="docutils literal"><span class="pre">&lt;decoder_dir&gt;</span></code> are used, the default decoder.xml will not be used. It must be specified explicitly.</p>
</div>
<p><strong>Allowed:</strong> Path and file name of decoder to load example: rules/decoder/decoder.xml</p>
</dd></dl>

<dl class="element">
<dt id="element-decoder_dir">
<code class="descname">decoder_dir</code><a class="headerlink" href="#element-decoder_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a directory of decoders.  The order of loaded files will be in alphebics order
and will not load any files that have been loaded before.
The path should be relative to the install directory, typically <code class="docutils literal"><span class="pre">/var/ossec</span></code>.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><p class="first"><em>pattern</em>: is a regex match string use to detemine if a file needs to be
loaded.</p>
<blockquote>
<div><ul class="simple">
<li><em>Defaults</em>: regex &#8221;.xml$&#8221; is used unless another one is specified.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p><strong>Allowed:</strong> Path to a directoy of decoder files</p>
<p><strong>Example:</strong></p>
<ol class="arabic">
<li><p class="first">Loading all decoders in directory /var/ossec/rules ending ending with _decoder.xml</p>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;ossec_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;decoder_dir&gt;</span>rules<span class="nt">&lt;/decoder_dir&gt;</span>
    <span class="nt">&lt;/rules&gt;</span>
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Loading all decoders in directory /var/ossec/rules/plugins/plugins/decoders
ending with .xml</p>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;ossec_config&gt;</span>
    <span class="nt">&lt;rules&gt;</span>
        <span class="nt">&lt;decoder_dir</span> <span class="na">pattern=</span><span class="s">&quot;.xml$&quot;</span><span class="nt">&gt;</span>rules/plugins/decoders<span class="nt">&lt;/decoder_dir&gt;</span>
    <span class="nt">&lt;/rules&gt;</span>
<span class="nt">&lt;/ossec_config&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If <code class="docutils literal"><span class="pre">&lt;decoder&gt;</span></code> or <code class="docutils literal"><span class="pre">&lt;decoder_dir&gt;</span></code> are used, the default decoder.xml will not be used. It must be specified explicitly.</p>
</div>
</dd></dl>

<dl class="element">
<dt id="element-list">
<code class="descname">list</code><a class="headerlink" href="#element-list" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a single cdb references for inclusion by other rules.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to the way cdb files are compiled using tmp files by the <cite>ossec-makelists</cite>
program the file extension should not be include in this directive.  ossec&#8217;s
tools will correctly append the correct .cdb or .txt extension as needed.</p>
</div>
<p><strong>Allowed:</strong> Path to a list file to be loaded and compiled.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;rules&gt;</span>
   <span class="nt">&lt;list&gt;</span>rules/lists/blocked_hosts<span class="nt">&lt;/list&gt;</span>
<span class="nt">&lt;/rules&gt;</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>

  <div class="section">
  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2015, OSSEC Project Team - OSSEC trademark and domain owned by Trend Micro, Inc. - Home page images courtesy of Pixbay.com.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>